#include <iostream>
using namespace std;

class node {
    int data;
    node* next_node;
public:
    node(int d = 0, node* nx = nullptr) {
        data = d;
        next_node = nx;
    }
    node* next() const {
        return next_node;
    }
    int retrieve() {
        return data;
    }
    void setnext(node* nn) {
        next_node = nn;
    }
};

class list {
    node* head;
public:
    list() {
        head = nullptr;
    }

    bool empty() {
        return (head == nullptr);
    }

    void setLastToHead(node* head) {
        if (head == nullptr)
            return;
        node* ptr;
        for (ptr = head; ptr->next() != head && ptr->next() != nullptr; ptr = ptr->next());
        ptr->setnext(head);
    }

    void push_front(int a) {
        if (empty()) {
            head = new node(a, nullptr);
            head->setnext(head);
        } 
        else {
            node* newnode = new node(a, head);
            head = newnode;
            setLastToHead(head);
        }
    }

    void push_back(int a) {
        if (empty()) {
            head = new node(a, nullptr);
            head->setnext(head);
            return;
        }

        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next());
        ptr->setnext(new node(a, head));

        setLastToHead(head);
    }

    void pop_front() {
        if (empty()) {
            throw "Underflow";
        }

        if (head->next() == head) {
            delete head;
            head = nullptr;
            return;
        }

        node* temp = head;
        head = head->next();
        delete temp;

        setLastToHead(head);
    }

    void pop_back() {
        if (empty()) {
            throw "Underflow";
        }

        if (head->next() == head) {
            delete head;
            head = nullptr;
            return;
        }

        node* prev = nullptr;
        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next()) {
            prev = ptr;
        }

        prev->setnext(head);
        delete ptr;
    }

    void display() {
        if (empty()) {
            cout << "List is empty\n";
            return;
        }

        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next()) {
            cout << ptr->retrieve() << "\t";
        }
        cout << ptr->retrieve() << "\n";
    }

    int count(int a) {
        if (empty()) return 0;

        int cnt = 0;
        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next()) {
            if (ptr->retrieve() == a)
                cnt++;
        }
        if (ptr->retrieve() == a) cnt++;
        return cnt;
    }

    void erase_in_between(int n) {
        if (empty()) {
            cout << "List is empty.\n";
            return;
        }

        if (head->retrieve() == n) {
            pop_front();
            return;
        }

        node* prev = nullptr;
        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next()) {
            if (ptr->retrieve() == n) break;
            prev = ptr;
        }

        if (ptr->retrieve() != n) {
            cout << "Element not found.\n";
            return;
        }

        prev->setnext(ptr->next());
        delete ptr;
    }

    void insert_in_between(int n, int value) {
        if (empty()) {
            cout << "List is empty.\n";
            return;
        }

        node* ptr;
        for (ptr = head; ptr->next() != head; ptr = ptr->next()) {
            if (ptr->retrieve() == n) break;
        }

        if (ptr->retrieve() != n) {
            cout << "Element not found.\n";
            return;
        }

        node* newnode = new node(value, ptr->next());
        ptr->setnext(newnode);
    }
};

int main() {
    list s1;
    s1.push_front(5);
    s1.push_front(4);
    s1.push_front(3);
    s1.push_front(2);
    s1.push_front(1);

    s1.display();

    s1.push_back(6);
    s1.display();

    s1.insert_in_between(3, 99);
    s1.display();

    s1.erase_in_between(4);
    s1.display();

    s1.pop_front();
    s1.display();

    s1.pop_back();
    s1.display();

    cout << "Count of 3: " << s1.count(3) << endl;

    return 0;
}
